\documentclass{beamer}
\usetheme{AnnArbor}
\usecolortheme{beaver}
\usepackage{tikz}
\usepackage{color}
\usepackage{listings}

\lstset{language=Java,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\footnotesize\color{blue}\ttfamily,
  commentstyle=\footnotesize\color{gray}\ttfamily,
}

\definecolor{darkred}{rgb}{0.8,0,0}

\setbeamercolor{title}{fg=white,bg=darkred!80!black}
\setbeamercolor{frametitle}{fg=darkred!80!black,bg=white}
%\setbeamercolor{section in head/foot}{fg=green,bg=yellow}
%\setbeamercolor{subsection in head/foot}{bg=white}
\begin{document}
\title{Getting started with RedDeer}   
\author{Andrej Podhradsky}
\date{\today} 
%\logo{\includegraphics[height=1cm]{reddeer_logo.png}\vspace{220pt}}

\addtobeamertemplate{title page}{\center{\includegraphics[height=2cm]{reddeer_logo.png}}}{}

\addtobeamertemplate{frametitle}{}{
\begin{tikzpicture}[remember picture,overlay]
\node[anchor=north east,yshift=-8pt] at (current page.north east) {\includegraphics[height=1cm]{reddeer_logo.png}};
\end{tikzpicture}}

\frame{\titlepage} 

\frame{\frametitle{Table of contents}\tableofcontents} 


\section{Introduction}
\subsection{RedDeer Introduction}
\begin{frame}[fragile]
\frametitle{RedDeer Introduction}
\begin{itemize}
\item Framework for automating eclipse tests\\\url{https://github.com/jboss-reddeer/reddeer/wiki}
\item Tests are built and executed by tycho plugin (as all eclipse plugins)
\item Example
\begin{lstlisting}
new PushButton("OK").click();
new LabeledText("Name").setText("test-name");
new TextEditor("Demo.java").save();
\end{lstlisting}
\item How it works?
\begin{itemize}
\item Each component is found in the constructor
\item The appropriate method (or event) is called in the main thread
\item Waiting until the operation has finished
\end{itemize}
\end{itemize}
\end{frame}

\subsection{RedDeer Hi-Level API}
\begin{frame}[fragile]
\frametitle{RedDeer Hi-Level API}
\begin{itemize}
\item This is key API for building functional tests by using RedDeer
\item Wizards
\begin{lstlisting}
NewJavaClassWizardDialog wizard =
        new NewJavaClassWizardDialog();
wizard.open();
wizard.getFirstPage().setName("HelloWorld");
wizard.getFirstPage().setPackage("com.example");
wizard.finish();
\end{lstlisting}
\item Views
\begin{lstlisting}
ProblemsView problemsView = new ProblemsView();
problemsView.open();
problemsView.getAllErrors();
problemsView.getAllWarnings();
\end{lstlisting}
\end{itemize}
\end{frame}


\section{Test Execution}

\subsection{Prerequisite}
\begin{frame}[fragile]
\frametitle{Prerequisite}
\begin{itemize}
\item Download RedDeer IDE 0.6.0\\\url{http://download.eng.brq.redhat.com/scratch/apodhrad}
\item Checkout RedDeer quickstart\\\url{https://github.com/apodhrad/reddeer-quickstart}
\item Display server, e.g. vnc\\We need isolated display since other events can affect our tests
\begin{lstlisting}[language=sh]
sudo yum install tigervnc tigervnc-server
vncpasswd    // set password
vncserver :2 -geometry 1500x900
vncviewer :2
\end{lstlisting}
\item Run the quickstart
\begin{lstlisting}[language=sh]
DISPLAY=:2 mvn clean verify
\end{lstlisting}
\item Each test class must be annotated with
\begin{lstlisting}[language=Java]
@RunWith(RedDeerSuite.class)
\end{lstlisting}
\end{itemize}
\end{frame}

\subsection{Using Maven and IDE}
\begin{frame}[fragile]
\frametitle{Using Maven and IDE}
\begin{itemize}
\item Execute tests
\begin{lstlisting}[language=sh]
DISPLAY=:2 mvn clean verify [-Dtest=...]
\end{lstlisting}
\item Executing tests against an existing eclipse instance
\begin{lstlisting}[language=sh]
DISPLAY=:2 mvn clean verify -Dtest.installPath=...
\end{lstlisting}
\item Execute tests from IDE as follows
\begin{enumerate}
\item Import the quickstart as maven project
\item Select Run \textgreater Run Configurations...
\item Find the configurtion RedDeer Test \textgreater BasicTest
\item On tab Environment check the variable DISPLAY with value :2
\end{enumerate}
\end{itemize}
\end{frame}

\subsection{Debugging}
\begin{frame}[fragile]
\frametitle{Debugging}
\begin{itemize}
\item You can debug RedDeer tests as any other JUnit tests
\item Remote debugging (on localhost, jenkins, ...)
\begin{lstlisting}[language=sh]
DISPLAY=:2 mvn clean verify -DdebugPort=8001
\end{lstlisting}
Then, in IDE do as follows
\begin{enumerate}
\item Select Run \textgreater Debug Configurations...
\item Create new Remote Java Application
\item Select Standard (Socket Attach) as connection type
\item Set package, host and port (8001)
\end{enumerate}
\end{itemize}
\end{frame}


\section{RedDeer in Details}

\subsection{Recorder}
\begin{frame}[fragile]
\frametitle{Recorder}
\begin{enumerate}
\item File \textgreater New \textgreater Other... \textgreater Run Test Recorder
\item Select basic dialog
\item Choose RedDeer SWT as target bot API
\item Start recording
\end{enumerate}
\begin{itemize}
\item Record creating new BPEL project and process
\end{itemize}

\end{frame}

\subsection{Waits and timeouts}
\begin{frame}[fragile]
\frametitle{Waits and timeouts}
\begin{itemize}
\item Used in case when tests have to wait for some time or condition to be passed.
\item Usage
\begin{lstlisting}
AbstractWait.sleep(TimePeriod.SHORT);
new WaitUntil(new ShellWithTextIsActive("Delete Server"));
new WaitWhile(new JobIsRunning(), TimePeriod.LONG);
\end{lstlisting}
\item You can create our own condition, just implement WaitCondition
\begin{lstlisting}
public interface WaitCondition {

  boolean test();

  String description();

}
\end{lstlisting}
\end{itemize}
\end{frame}

\subsection{Matchers}
\begin{frame}[fragile]
\frametitle{Matchers}
\begin{itemize}
\item From hamcrest library
\item Widely used in widget searching
\item Provided by RedDeer: TextMatcher, RegexMatcher, LabelMatcher
\item You can create your own matcher by extending BaseMatcher
\item Just implement the following method
\begin{lstlisting}
public boolean matches(Object item);
\end{lstlisting}
\end{itemize}
\end{frame}

\subsection{Requirements}
\begin{frame}[fragile]
\frametitle{Requirements}
\begin{itemize}
\item Requirement represents one prerequisite required by a test
\item Similar to @BeforeClass but if a requirement cannot be fulfilled the test is not executed.
\item Examples
\begin{lstlisting}
@OpenPerspective(BPELPerspective.class)

@SwitchYard(server = @Server(type = ANY, state = RUNNING))
\end{lstlisting}
\end{itemize}
\end{frame}


\section{Learning Materials}
\begin{frame}[fragile]
\frametitle{Learning Materials}
\begin{itemize}
\item RedDeer Wiki\\\url{https://github.com/jboss-reddeer/reddeer/wiki}
\item Say Hello to Red Deer\\\url{http://java.dzone.com/articles/hunting-swt-test-framework-say}
\item How Red Deer Helps you to Debug Failed Tests\\\url{http://architects.dzone.com/articles/if-bad-things-happen-good}
\item Creating Complex Test Configurations with Red Deer\\\url{http://java.dzone.com/articles/creating-complex-test}
\item JBTIS Tests\\\url{https://github.com/jbosstools/jbosstools-integration-stack-tests}
\end{itemize}
\end{frame}

\end{document}
